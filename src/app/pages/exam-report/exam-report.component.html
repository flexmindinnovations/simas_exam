<div class="exam-report-container page-container">
    <p-panel [toggleable]="true" [(collapsed)]="isPanelCollapsed" class="panel-component">
        <ng-template pTemplate="header">
            <div class="flex flex-col lg:flex-row xl:flex-row 2xl:flex-row items-center justify-start space-x-2">
                <div class="header min-w-40 flex items-start justify-start gap-2">
                    <i class="pi pi-cog"></i>
                    <span>
                        Exam Report Options
                    </span>
                </div>
                @if (isPanelCollapsed) {
                <br />
                <div class="!ml-5 hidden lg:flex xl:flex 2xl:flex items-center justify-start space-x-2 w-full">
                    <p-chip class="chip-component min-w-32" label="Exam Type: {{selectedExamType}}" />
                    <p-chip class="chip-component min-w-24" label="Level: {{selectedLevel}}" />
                    <p-chip class="chip-component  min-w-24" label="Round: {{selectedRound}}" />
                    <p-chip class="chip-component  min-w-24" label="Student: {{selectedStudent}}" />
                </div>
                }
            </div>
        </ng-template>
        <div
            class="criteria-container flex items-end justify-start lg:justify-start xl:justify-start 2xl:justify-start gap-3 flex-wrap md:flex-auto lg:flex-auto xl:flex-auto 2xl:flex-auto lg:gap-5 xl:gap-5 2xl:gap-5 max-w-72 px-3 lg:px-5 xl:px-5 2xl:px-5 min-w-full mb-5">
            <div class="flex flex-col items-start w-full max-w-48">
                <label for="examType">Exam Type</label>
                <p-dropdown appendTo="body" inputId="examType" [options]="examTypeList" ariaLabelledBy="value"
                    [loading]="examTypeListLoading" loadingIcon="pi pi-spin pi-spinner"
                    [disabled]="isSearchActionLoading" [(ngModel)]="selectedExamType" placeholder="Select"
                    (onChange)="handleOnExamTypeChange($event)" optionValue="examTypeId" optionLabel="examTypeName"
                    [filter]="true" filterBy="examTypeName" [showClear]="false" />
            </div>

            <div class="flex flex-col items-start w-full max-w-48">
                <label for="levelName">Level</label>
                <p-dropdown appendTo="body" inputId="levelName" [options]="levelNameList" ariaLabelledBy="value"
                    [loading]="levelListLoading" loadingIcon="pi pi-spin pi-spinner" [disabled]="isSearchActionLoading"
                    [(ngModel)]="selectedLevel" placeholder="Select" (onChange)="handleOnLevelNameChange($event)"
                    optionValue="levelId" optionLabel="levelName" [filter]="true" filterBy="levelName"
                    [showClear]="false" />
            </div>

            @if(selectedLevel) {
            <div class="flex flex-col items-start w-full max-w-48">
                <label for="roundName">Round</label>
                <p-dropdown appendTo="body" inputId="roundName" [options]="roundNameList" ariaLabelledBy="value"
                    [loading]="roundListLoading" loadingIcon="pi pi-spin pi-spinner" [disabled]="isSearchActionLoading"
                    [(ngModel)]="selectedRound" placeholder="Select" (onChange)="handleOnRoundNameChange($event)"
                    optionValue="roundId" optionLabel="roundName" [filter]="true" filterBy="roundName"
                    [showClear]="false" />
            </div>
            }

            <div class="flex flex-col items-start w-full max-w-48">
                <label for="selectedStudent">Student</label>
                <p-dropdown appendTo="body" inputId="selectedStudent" [options]="studentList" ariaLabelledBy="value"
                    [loading]="studentListLoading" loadingIcon="pi pi-spin pi-spinner"
                    [disabled]="isSearchActionLoading" [(ngModel)]="selectedStudent" placeholder="Select"
                    (onChange)="handleOnRoundNameChange($event)" optionValue="roundId" optionLabel="roundName"
                    [filter]="true" filterBy="roundName" [showClear]="false" />
            </div>


            <p-button label="Search" (onClick)="handleSearchAction()"
                [disabled]="isSearchDisabled || isSearchActionLoading" icon="pi pi-search" styleClass="py-2.5"
                severity="primary" [loading]="isSearchActionLoading" loadingIcon="pi pi-spin pi-spinner"></p-button>
        </div>
    </p-panel>
</div>